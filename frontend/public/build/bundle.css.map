{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "Dashboard.svelte",
    "Dispositivo.svelte",
    "HistorialDispositivo.svelte",
    "ListadoDispositivos.svelte",
    "Mapa.svelte",
    "NuevoDispositivo.svelte",
    "NoEncontrado.svelte"
  ],
  "sourcesContent": [
    "<script>\n    import Chart from \"svelte-frappe-charts\";\n    import Button, { Label, Icon } from \"@smui/button/bare.js\";\n    import { seriesServicio } from \"../servicios/series.servicio\";\n    import { onMount } from \"svelte\";\n\n    // dato pasado al componente\n    export let id;\n\n    // datos obtenidos del backend\n    let dispositivo;\n    let seriesHumedad;\n    let seriesTotales;\n    let seriesTemperatura;\n    let vLabels = [];\n    let vHumedad = [];\n    let vTemperatura = [];\n\n    onMount(async () => {\n        await seriesServicio\n            .obtenerDatos(id + \"-Humedad\")\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (seriesHumedad = resultado));\n        await seriesServicio\n            .obtenerDatos(id + \"-Temperatura\")\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (seriesTemperatura = resultado));\n            await seriesServicio\n            .obtenerDatos(id)\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (seriesTotales = resultado));\n        console.log(seriesHumedad.length);\n        console.log(seriesTemperatura.length);\n        console.log(seriesTotales);\n        const options = {\n            hour: \"numeric\",\n            minute: \"numeric\",\n            second: \"numeric\",\n            year: \"numeric\",\n            month: \"numeric\",\n            day: \"numeric\",\n        };\n        for (let i = 0; i < seriesHumedad.length; i++) {\n            vLabels.push(\n                new Date(seriesHumedad[i][0]).toLocaleDateString(\n                    \"es-es\",\n                    options\n                )\n            );\n            vHumedad.push(seriesHumedad[i][1]);\n            vTemperatura.push(seriesTemperatura[i][1]);\n        }\n    });\n\n    var data = {\n        labels: vLabels,\n        datasets: [\n            {\n                name: \"Temperatura\",\n                values: vTemperatura,\n            },\n            {\n                name: \"Humedad\",\n                values: vHumedad,\n            },\n        ],\n    };\n    let referencia;\n    const exportar = () => referencia.exportChart();\n</script>\n\n<style>\n    h2 {\n        color: #ff3e00;\n        font-size: 2em;\n        font-weight: 100;\n    }\n</style>\n\n<main>\n    <h2>Dispositivo {id}</h2>\n    <Chart {data} type=\"line\" bind:this={referencia} />\n    <Button on:click={exportar} variant=\"outlined\">\n        <Label>Exportar</Label>\n    </Button>\n    <a href=\"/\">\n        <Button variant=\"outlined\">\n            <Label>Mapa</Label>\n        </Button>\n    </a>\n    <a href=\"/dispositivos\">\n        <Button variant=\"outlined\">\n            <Label>Listado</Label>\n        </Button>\n    </a>\n</main>\n",
    "<script>\n    // validar formulario, basado en: https://codechips.me/svelte-form-validation-with-yup/\n\n    import { onMount } from \"svelte\";\n    import Button, { Label, Icon } from \"@smui/button/bare.js\";\n    import \"@smui/button/bare.css\";\n\n    import { dispositivosServicio } from \"../servicios/dispositivos.servicio\";\n    import { seriesServicio } from \"../servicios/series.servicio\";\n    import { dispositivoEsquema } from \"../esquemas/dispositivos.esquema\";\n\n    // dato pasado al componente\n    export let id;\n\n    // datos obtenidos del backend\n    let dispositivo;\n    let seriesHumedad;\n    let seriesTemperatura;\n\n    // datos formulario\n    let valores = {};\n    let errores = {};\n\n    onMount(async () => {\n        await dispositivosServicio\n            .obtenerDispositivo(id)\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (dispositivo = resultado));\n\n        valores.denominacion = dispositivo.denominacion;\n        valores.latitud = dispositivo.ubicacion.coordinates[1];\n        valores.longitud = dispositivo.ubicacion.coordinates[0];\n\n        await seriesServicio\n            .obtenerDatos(id + \"-Humedad\")\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (seriesHumedad = resultado));\n        await seriesServicio\n            .obtenerDatos(id + \"-Temperatura\")\n            .then((respuesta) => respuesta.json())\n            .then((respuesta) => (seriesTemperatura = respuesta));\n        console.log(seriesHumedad);\n        console.log(seriesTemperatura);\n        console.log(seriesHumedad.length);\n        for (let i = 0; i < seriesHumedad.length; i++) {\n            console.log(new Date(seriesHumedad[i][0]).toString());\n        }\n    });\n\n    const capturarErrores = ({ inner }) => {\n        return inner.reduce((acc, err) => {\n            return { ...acc, [err.path]: err.message };\n        }, {});\n    };\n\n    const guardar = () => {\n        dispositivoEsquema\n            .validate(valores, { abortEarly: false })\n            .then(() => {\n                valores.denominacion = valores.denominacion.toUpperCase();\n                dispositivosServicio\n                    .modificarDispositivo(dispositivo.id, valores)\n                    .then(() => location.replace(\"/dispositivos\"));\n            })\n            .catch((err) => (errores = capturarErrores(err)));\n    };\n</script>\n\n<style>\n    h2 {\n        color: #ff3e00;\n        font-size: 2em;\n        font-weight: 100;\n    }\n</style>\n\n<main>\n    <h2>Dispositivo</h2>\n\n    {#if dispositivo}\n        <p>Id <b>{dispositivo.id}</b></p>\n        <form on:submit|preventDefault={guardar}>\n            <label for=\"denominacion\">Denominación</label>\n            <div>\n                <input\n                    id=\"denominacion\"\n                    name=\"denominacion\"\n                    type=\"text\"\n                    bind:value={valores.denominacion}\n                    placeholder=\"denominación del dispositivo\" />\n                {#if errores.denominacion}{errores.denominacion}{/if}\n            </div>\n            <label for=\"latitud\">Latitud</label>\n            <div>\n                <input\n                    id=\"latitud\"\n                    name=\"latitud\"\n                    type=\"text\"\n                    bind:value={valores.latitud}\n                    placeholder=\"latitud del dispositivo\" />\n                {#if errores.latitud}{errores.latitud}{/if}\n            </div>\n            <label for=\"longitud\">Longitud</label>\n            <div>\n                <input\n                    id=\"longitud\"\n                    name=\"longitud\"\n                    type=\"text\"\n                    bind:value={valores.longitud}\n                    placeholder=\"longitud del dispositivo\" />\n                {#if errores.longitud}{errores.longitud}{/if}\n            </div>\n            <Button color=\"secondary\" variant=\"raised\" type=\"submit\">\n                Guardar\n            </Button>\n        </form>\n    {/if}\n\n    <hr />\n    <a href=\"/\">\n        <Button variant=\"outlined\">\n            <Label>Mapa</Label>\n        </Button>\n    </a>\n    <a href=\"/dispositivos\">\n        <Button variant=\"outlined\">\n            <Label>Listado</Label>\n        </Button>\n    </a>\n</main>\n",
    "<script>\n    import { onMount } from \"svelte\";\n    import Button, { Label, Icon } from \"@smui/button/bare.js\";\n    import \"@smui/button/bare.css\";\n\n    import { dispositivosServicio } from \"../servicios/dispositivos.servicio\";\n    import { seriesServicio } from \"../servicios/series.servicio\";\n\n    // dato pasado al componente\n    export let id;\n\n    // datos obtenidos del backend\n    let dispositivo;\n    let seriesHumedad;\n    let seriesTemperatura;\n    let seriesActuador;\n    let terminado;\n\n    onMount(async () => {\n        try {\n            await seriesServicio\n                .obtenerDatos(id + \"-Humedad\")\n                .then((respuesta) => respuesta.json())\n                .then((resultado) => (seriesHumedad = resultado));\n            await seriesServicio\n                .obtenerDatos(id + \"-Temperatura\")\n                .then((respuesta) => respuesta.json())\n                .then((respuesta) => (seriesTemperatura = respuesta));\n            await seriesServicio\n                .obtenerDatos(id + \"-Actuador\")\n                .then((respuesta) => respuesta.json())\n                .then((resultado) => (seriesHumedad = resultado));\n            terminado = true;\n        } catch (err) {\n            terminado = true;\n        }\n    });\n</script>\n\n<style>\n    h2 {\n        color: #ff3e00;\n        font-size: 2em;\n        font-weight: 100;\n    }\n</style>\n\n<main>\n    <h2>Dispositivo</h2>\n\n    {#if terminado}\n        <p>Id <b>{id}</b></p>\n    {/if}\n\n    <hr />\n    <a href=\"/dispositivos/{id}\">\n        <Button variant=\"outlined\">\n            <Label>Volver</Label>\n        </Button>\n    </a>\n</main>\n",
    "<script>\n    import { onMount } from \"svelte\";\n    import DataTable, { Head, Body, Row, Cell } from \"@smui/data-table/bare.js\";\n    import \"@smui/data-table/bare.css\";\n    import Button, { Label, Icon } from \"@smui/button/bare.js\";\n    import \"@smui/button/bare.css\";\n\n    import { dispositivosServicio } from \"../servicios/dispositivos.servicio\";\n\n    let dispositivos = [];\n    let id;\n\n    onMount(async () => {\n        await dispositivosServicio\n            .listarDispositivos()\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (dispositivos = resultado));\n    });\n\n    async function eliminar(id) {\n        await dispositivosServicio.eliminarDispositivo(id);\n        await dispositivosServicio\n            .listarDispositivos()\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (dispositivos = resultado));\n    }\n</script>\n\n<style>\n    h2 {\n        color: #ff3e00;\n        font-size: 2em;\n        font-weight: 100;\n    }\n</style>\n\n<main>\n    <h2>Dispositivos</h2>\n    <a href=\"/\">\n        <Button variant=\"outlined\">\n            <Label>Mapa</Label>\n        </Button>\n    </a>\n    <a href=\"/dispositivos/nuevo\">\n        <Button variant=\"outlined\">\n            <Label>Nuevo dispositivo</Label>\n        </Button>\n    </a>\n    <br />\n    {#if dispositivos}\n        <DataTable table$aria-label=\"Listado de Dispositivos\">\n            <Head>\n                <Row>\n                    <Cell>Id dispositivo</Cell>\n                    <Cell>Denominación</Cell>\n                </Row>\n            </Head>\n            <Body>\n                {#each dispositivos as dispositivo}\n                    <Row>\n                        <Cell>{dispositivo.id}</Cell>\n                        <Cell>{dispositivo.denominacion}</Cell>\n                        <Cell>\n                            <a href=\"/dispositivos/{dispositivo.id}\">\n                                <Button color=\"secondary\" variant=\"raised\">\n                                    <Label>Editar</Label>\n                                </Button>\n                            </a>\n                        </Cell>\n                        <Cell>\n                            <Button\n                                on:click={() => eliminar(dispositivo.id)}\n                                variant=\"raised\">\n                                <Label>Eliminar</Label>\n                            </Button>\n                        </Cell>\n                        <Cell>\n                            <a href=\"/dispositivos/{dispositivo.id}/dashboard\">\n                                <Button variant=\"outlined\">\n                                    <Label>Dashboard</Label>\n                                </Button>\n                            </a>\n                        </Cell>\n                    </Row>\n                {/each}\n            </Body>\n        </DataTable>\n    {/if}\n</main>\n",
    "<script>\n    import * as L from \"leaflet\";\n    import { onMount } from \"svelte\";\n    import Button, { Label, Icon } from \"@smui/button/bare.js\";\n    import \"@smui/button/bare.css\";\n\n    import { dispositivosServicio } from \"../servicios/dispositivos.servicio\";\n\n    // variable del mapa\n    let mapa;\n    // variable de dispositivos (para mostrar en el mapa)\n    let dispositivos = [];\n    let ubicaciones = [];\n    let centro;\n\n    onMount(async () => {\n        await dispositivosServicio\n            .listarDispositivos()\n            .then((respuesta) => respuesta.json())\n            .then((resultado) => (dispositivos = resultado));\n        await marcadores();\n    });\n\n    async function marcadores() {\n        if (dispositivos.length > 0) {\n            let coordenada0max = 0;\n            let coordenada0min = 0;\n            let coordenada1max = 0;\n            let coordenada1min = 0;\n            for (let i = 0; i < dispositivos.length; i++) {\n                ubicaciones.push([\n                    dispositivos[i].denominacion,\n                    dispositivos[i].ubicacion.coordinates[1],\n                    dispositivos[i].ubicacion.coordinates[0],\n                    dispositivos[i].id,\n                ]);\n                if (i === 0) {\n                    coordenada0max = dispositivos[i].ubicacion.coordinates[1];\n                    coordenada0min = dispositivos[i].ubicacion.coordinates[1];\n                    coordenada1max = dispositivos[i].ubicacion.coordinates[0];\n                    coordenada1min = dispositivos[i].ubicacion.coordinates[0];                    \n                } else {\n                    if (coordenada0max < dispositivos[i].ubicacion.coordinates[1]) {\n                        coordenada0max = dispositivos[i].ubicacion.coordinates[1];\n                    }\n                    if (coordenada0min > dispositivos[i].ubicacion.coordinates[1]) {\n                        coordenada0min = dispositivos[i].ubicacion.coordinates[1];\n                    }\n\n                    if (coordenada1max < dispositivos[i].ubicacion.coordinates[0]) {\n                        coordenada1max = dispositivos[i].ubicacion.coordinates[0];\n                    }\n                    if (coordenada1min > dispositivos[i].ubicacion.coordinates[0]) {\n                        coordenada1min = dispositivos[i].ubicacion.coordinates[0];\n                    }                    \n                }\n            }\n            centro = [\n                (coordenada0max + coordenada0min) / 2,\n                (coordenada1max + coordenada1min) / 2,\n            ];\n        }\n    }\n\n    function crearMapa(contenedor) {\n        console.log(centro);\n        let m = L.map(contenedor).setView([centro[0], centro[1]], 9);\n        L.tileLayer(\n            \"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png\",\n            {\n                attribution: `&copy;<a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a>,\n          &copy;<a href=\"https://carto.com/attributions\" target=\"_blank\">CARTO</a>`,\n                subdomains: \"abcd\",\n                maxZoom: 14,\n            }\n        ).addTo(m);\n\n        return m;\n    }\n\n    function accionesMapa(contenedor) {\n        // creo mapa\n        mapa = crearMapa(contenedor);\n\n        for (let i = 0; i < ubicaciones.length; i++) {\n            var marker = new L.marker([ubicaciones[i][1], ubicaciones[i][2]])\n                .bindPopup(\n                    `${ubicaciones[i][0]} </br>\n                <a href=\"/dispositivos/${ubicaciones[i][3]}/dashboard\"> ver dashboard </a> </br>\n                <a href=\"/dispositivos/${ubicaciones[i][3]}\"> editarlo </a>`\n                )\n                .addTo(mapa);\n        }\n\n        return {\n            destroy: () => {\n                mapa.remove();\n            },\n        };\n    }\n</script>\n\n<style>\n    h2 {\n        color: #ff3e00;\n        font-size: 2em;\n        font-weight: 100;\n    }\n</style>\n\n<main>\n    <h2>Mapa de dispositivos</h2>\n\n    <a href=\"/dispositivos\">\n        <Button variant=\"outlined\">\n            <Label>Listado</Label>\n        </Button>\n    </a>\n    <a href=\"/dispositivos/nuevo\">\n        <Button variant=\"outlined\">\n            <Label>Nuevo dispositivo</Label>\n        </Button>\n    </a>\n\n    {#if centro && ubicaciones}\n        <div class=\"map\" style=\"height:400px;width:100%\" use:accionesMapa />\n    {/if}\n</main>\n",
    "<script>\n    // validar formulario, basado en: https://codechips.me/svelte-form-validation-with-yup/\n\n    import { onMount } from \"svelte\";\n    import Button, { Label, Icon } from \"@smui/button/bare.js\";\n    import \"@smui/button/bare.css\";\n\n    import { dispositivosServicio } from \"../servicios/dispositivos.servicio\";\n    import { dispositivoEsquema } from \"../esquemas/dispositivos.esquema\";\n    import Ruteador from \"../rutas/Ruteador.svelte\";\n\n    let dispositivo;\n\n    // datos formulario\n    let valores = {};\n    let errores = {};\n\n    onMount(async () => {\n        valores.denominacion = \"\";\n        valores.latitud = \"\";\n        valores.longitud = \"\";\n    });\n\n    const capturarErrores = ({ inner }) => {\n        return inner.reduce((acc, err) => {\n            return { ...acc, [err.path]: err.message };\n        }, {});\n    };\n\n    const guardar = () => {\n        dispositivoEsquema\n            .validate(valores, { abortEarly: false })\n            .then(() => {\n                valores.denominacion = valores.denominacion.toUpperCase();\n                dispositivosServicio.agregarDispositivo(valores).\n                then(() => location.replace(\"/dispositivos\") );\n                \n            })\n            .catch((err) => (errores = capturarErrores(err)));\n    };\n</script>\n\n<style>\n    h2 {\n        color: #ff3e00;\n        font-size: 2em;\n        font-weight: 100;\n    }\n</style>\n\n<main>\n    <h2>Dispositivo Nuevo</h2>\n\n    <form on:submit|preventDefault={guardar}>\n        <label for=\"denominacion\">Denominación</label>\n        <div>\n            <input\n                id=\"denominacion\"\n                name=\"denominacion\"\n                type=\"text\"\n                bind:value={valores.denominacion}\n                placeholder=\"denominación del dispositivo\" />\n            {#if errores.denominacion}{errores.denominacion}{/if}\n        </div>\n        <label for=\"latitud\">Latitud</label>\n        <div>\n            <input\n                id=\"latitud\"\n                name=\"latitud\"\n                type=\"text\"\n                bind:value={valores.latitud}\n                placeholder=\"latitud del dispositivo\" />\n            {#if errores.latitud}{errores.latitud}{/if}\n        </div>\n        <label for=\"longitud\">Longitud</label>\n        <div>\n            <input\n                id=\"longitud\"\n                name=\"longitud\"\n                type=\"text\"\n                bind:value={valores.longitud}\n                placeholder=\"longitud del dispositivo\" />\n            {#if errores.longitud}{errores.longitud}{/if}\n        </div>\n        <Button color=\"secondary\" variant=\"raised\" type=\"submit\">Guardar</Button>\n    </form>\n\n    <hr />\n    <a href=\"/\">\n        <Button variant=\"outlined\">\n            <Label>Mapa</Label>\n        </Button>\n    </a>\n    <a href=\"/dispositivos\">\n        <Button variant=\"outlined\">\n            <Label>Listado</Label>\n        </Button>\n    </a>\n</main>\n",
    "<script>\n  /*\n  import { registrar, rutaActiva } from \"./Ruteador.svelte\";\n\n  export let path = \"/*\";\n  export let componente = null;\n\n  registrar({ path, componente });\n  */\n</script>\n\n<style>\n  h2 {\n    color: #ff3e00;\n    text-transform: uppercase;\n    font-size: 4em;\n    font-weight: 100;\n  }\n</style>\n\n<main>\n  <!--\n  {#if $rutaActiva.path === path}\n    <svelte:component this={componente} />\n    <slot />\n  {/if}\n    -->\n  <h2>Lo siento.</h2>\n  <h2>Página no encontrada.</h2>\n  <a href=\"/\">Volver</a>\n</main>\n"
  ],
  "names": [],
  "mappings": "AAwEI,EAAE,cAAC,CAAC,AACA,KAAK,CAAE,OAAO,CACd,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AACpB,CAAC;ACPD,EAAE,cAAC,CAAC,AACA,KAAK,CAAE,OAAO,CACd,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AACpB,CAAC;ACjCD,EAAE,cAAC,CAAC,AACA,KAAK,CAAE,OAAO,CACd,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AACpB,CAAC;ACfD,EAAE,cAAC,CAAC,AACA,KAAK,CAAE,OAAO,CACd,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AACpB,CAAC;ACsED,EAAE,cAAC,CAAC,AACA,KAAK,CAAE,OAAO,CACd,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AACpB,CAAC;AChED,EAAE,cAAC,CAAC,AACA,KAAK,CAAE,OAAO,CACd,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AACpB,CAAC;ACnCH,EAAE,eAAC,CAAC,AACF,KAAK,CAAE,OAAO,CACd,cAAc,CAAE,SAAS,CACzB,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AAClB,CAAC"
}